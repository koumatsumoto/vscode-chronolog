# clog ファイル形式仕様書

## 概要

`.clog` ファイル形式は以下の要素から構成されるハイブリッドテキスト形式です：

1. YAML形式のメタデータ部分（frontmatter）
2. Markdown形式のbody部分（body）

この形式は構造化されたメタデータとリッチテキストコンテンツを組み合わせており、ドキュメント作成、ノート取り、コンテンツ管理アプリケーションなどに適しています。

## ファイル構造

`.clog` ファイルは以下の構造を持ちます：

```
---
# YAMLフロントマター（メタデータ）開始
key1: value1
key2: value2
...
---

# Markdown body開始
Markdown形式で書かれたコンテンツ...
```

## パース規則

1. **ファイル区切り**:

   - ファイルは `---`（ハイフン3つ）のみを含む行で始まる
   - frontmatter部分は別の `---` のみを含む行で終わる
   - frontmatterとbodyの間には空行がある
   - bodyはこの空行の後から始まり、ファイルの最後まで続く

2. **パース処理**:
   - 最初に、`---` の区切りでファイルを分割してfrontmatterとbodyを分ける
   - frontmatterをYAMLパーサーでパースする
   - bodyをMarkdownパーサーでパースする

## 各セクションの詳細

### Frontmatter

- 開始と終了の `---` 行の間に含まれる
- 有効なYAML形式である必要がある
- ドキュメントに関するメタデータを含む
- 必須フィールド：
  - `id`: ファイル名（拡張子を除く）と同じISO8601形式の日時文字列（例: 20250511T082117）
  - `title`: 文字列（空でない）
  - `created`: ISO8601形式の日時文字列（YYYYMMDDThhmmss）

### Body

- 終了 `---` 行の後の空行に続いて始まる
- 標準的なMarkdown形式で書かれている
- ドキュメントのメインコンテンツを含む

## 技術仕様

- **エンコーディング**: UTF-8のみ
- **YAML制約**: 特になし
- **ファイル拡張子**: `.clog`のみ
- **エスケープ処理**: frontmatter内での `---` は禁止。パース時は行をtrimして `---` となっている部分を区切りとして使用（最初と次の `---` のみ）。body中の `---` は通常のMarkdownとして扱う

## 実装上の注意

`.clog` ファイルのパーサーを実装する際は：

1. まず `---` 区切りを特定してfrontmatterを抽出する
2. frontmatterをYAMLパーサーでパースする
3. bodyコンテンツを抽出する（2番目の `---` の後の空行以降すべて）
4. bodyコンテンツをMarkdownパーサーで処理する

実装例（TypeScript）:

```ts
import { parseClogFile } from "../../src/core/clog";
// content: string = clogファイルの内容
const { frontmatter, body } = parseClogFile(content);
```

この2段階のパース方法により、アプリケーションは構造化されたメタデータとフォーマットされたコンテンツの両方を扱うことができます。

## 例

```
---
id: 20250510T123000
title: サンプルドキュメント
created: 20250510T123000
author: 山田太郎
tags:
  - ドキュメント
  - サンプル
---

# サンプルドキュメント

これは frontmatter と Markdown コンテンツを持つ `.clog` ファイルの例です。

## セクション1

セクション1のコンテンツがここに入ります。

## セクション2

セクション2のコンテンツがここに入ります。
```
